# A*アルゴリズム ベンチマークシステム

## 概要

このプロジェクトは、2025年度高専プロコン競技部門の解法調査・比較のためのベンチマークシステムです。A*アルゴリズムを使用したパズル解法の性能を評価し、可視化するためのツール群を提供します。

## システム構成

```
benchmark/
├── astar_manhattan          # A*アルゴリズム実行ファイル（マンハッタン距離ヒューリスティック）
├── benchmark.py  # Streamlit可視化ダッシュボード
├── make_p.py              # 問題生成スクリプト
├── make_p_csv.py          # 問題サマリーCSV生成スクリプト
├── problems/              # 問題データディレクトリ（4x4～24x24）
├── problems_summary.csv   # 問題統計情報
└── README.md             # このファイル
```

## 主要機能

### 1. 問題生成 (`make_p.py`)

- **サイズ範囲**: 4x4 ～ 24x24のパズル
- **問題数**: 各サイズあたり25問題
- **重複回避**: SHA256ハッシュによる一意性保証
- **出力形式**: JSON形式の問題ファイル

#### 実行方法
```bash
python make_p.py
```

### 2. 問題統計生成 (`make_p_csv.py`)

各問題の理論値を計算し、CSVファイルに出力します。

- **最適解推定**: `3n²/8` 公式を使用
- **マンハッタン距離ベース**: 最小値・最大値を計算
- **出力**: `problems_summary.csv`

#### 実行方法
```bash
python make_p_csv.py
```

### 3. 可視化ダッシュボード (`benchmark.py`)

Streamlitを使用したインタラクティブな結果可視化システム。

#### 機能
- **パフォーマンス概要**: 解決率、平均計算時間、探索効率
- **時間性能分析**: サイズ別計算時間、分布グラフ
- **探索性能分析**: ノード数分布、効率性指標
- **解の品質分析**: 理論最適解との比較
- **総合分析**: ヒートマップによる多次元評価
- **詳細データテーブル**: フィルタリング可能なデータ表示

#### 実行方法
```bash
streamlit run app.py
```

## 評価指標

### 基本指標
- **解決率**: 成功した問題数 / 総問題数
- **計算時間**: アルゴリズムの実行時間（ミリ秒）
- **探索ノード数**: A*で探索したノード数
- **解の手数**: 実際の解の手数

### 品質指標
- **推定最適解との差分**: `実際手数 - 3n²/8`
- **理論最大値との差分**: `実際手数 - n²`
- **探索効率**: `探索ノード数 / 秒`
- **総合スコア**: 正規化された複合指標

### マンハッタン距離ベース指標
- **最小値**: `(マンハッタン距離 - ペア数) / 2`
- **最大値**: `マンハッタン距離`

## 問題の特性

### サイズ分布
- **小規模**: 4x4 ～ 8x8（基本性能確認）
- **中規模**: 9x9 ～ 16x16（実用性評価）
- **大規模**: 17x17 ～ 24x24（スケーラビリティ評価）

### 問題構造
- **ペア配置**: 同じ数字のペアをランダム配置
- **奇数サイズ**: 余りセルに追加番号割り当て
- **一意性**: SHA256ハッシュによる重複回避

## 使用方法

### 1. 初回セットアップ
```bash
# 問題生成
python make_p.py

# 問題統計生成
python make_p_csv.py
```

### 2. ベンチマーク実行
```bash
# コマンドライン実行
python app.py

# または可視化ダッシュボードから実行
streamlit run streamlit_benchmark.py
```

### 3. 結果確認
- `benchmark_results.csv`: 詳細結果データ
- `benchmark_summary.json`: サマリー統計
- Streamlitダッシュボード: インタラクティブ可視化

## 出力ファイル

### `benchmark_results.csv`
各問題の詳細結果を含むCSVファイル。

```csv
problem_id,size,num_moves,calculation_time_ms,nodes_explored,solved,...
```

### `benchmark_summary.json`
全体統計のサマリー情報。

```json
{
  "total_problems": 525,
  "solved_problems": 520,
  "avg_calculation_time_ms": 45.2,
  "avg_nodes_explored": 1250.5,
  ...
}
```

### `problems_summary.csv`
各問題の理論値情報。

```csv
problem_id,size,optimal_moves,n_squared,manhattan_min,manhattan_max
```

## システム要件

### 必須
- Python 3.8以上
- A*アルゴリズム実行ファイル（`astar_manhattan`）

### Pythonパッケージ
```bash
pip install streamlit pandas numpy plotly json pathlib subprocess
```

## カスタマイズ

### 問題生成設定
`make_p.py`内のパラメータを変更：

```python
save_problems(
    base_dir="problems",
    sizes=range(4, 25),  # サイズ範囲
    per_size=25          # 各サイズの問題数
)
```

### ベンチマーク設定
`streamlit_benchmark.py`のサイドバーから：

- **実行ファイルパス**: A*アルゴリズムの実行ファイル
- **問題ディレクトリ**: 問題ファイルの格納場所

## トラブルシューティング

### よくある問題

1. **実行ファイルが見つからない**
   ```
   実行ファイル './astar_manhattan' が見つかりません
   ```
   → 実行ファイルのパスを確認し、実行権限を付与してください。

2. **問題ファイルが見つからない**
   ```
   問題ディレクトリ 'problems' が見つかりません
   ```
   → `make_p.py`を実行して問題を生成してください。

3. **メモリ不足エラー**
   → 大規模問題の実行時にメモリ不足が発生する場合は、問題サイズを制限してください。

4. **タイムアウト**
   → 実行時間制限（60秒）を超える問題がある場合は、アルゴリズムの最適化を検討してください。

## 貢献

バグ報告や機能改善の提案は、プロジェクトリポジトリのIssueまでお願いします。

## ライセンス

このプロジェクトは2025年度高専プロコン競技部門の解法調査を目的として作成されました。

---

**🚀 高専プロコン A*ベンチマークシステム | Built with Python & Streamlit**